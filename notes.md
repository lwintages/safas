Refactor codebase with Z [fnoidi] line 4.1
